@model PagedList.IPagedList<dvhd.Models.HoSo>
@using PagedList.Mvc; 
@{
    ViewBag.Title = "Danh sách đối tượng vi phạm";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script>
    document.addEventListener("keydown", autosearch);
    function autosearch(event) {
        var keyCode = ('which' in event) ? event.which : event.keyCode;
        //alert("The Unicode key code is: " + keyCode);
        if (keyCode == 13) {
            timhoso();
        }

    }
</script>
<style id="styleDetail" type="text/css">
   /* Ban In css*/
    .tbBanIn {
        width:99%;
        border: 1px solid #36813c;
        border-collapse: collapse;
    }
    .tbBanIn td, .tbBanIn th {
        border: 1px solid #36813c;
        padding: 2px !important;
    }
    .tbBanIn label {
        margin: 0 !important;
    }
</style>


<!-- Reservation form -->
<section id="reservation-form" style="margin-top:10px;" class="noPrint">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h3 style="margin-left:0px;">Danh Sách Đối Tượng Vi Phạm</h3>    
        <p>* Khoảng thời gian từ ngày đến ngày tính là thời gian vi phạm</p>            
        <form class="form-inline reservation-horizontal clearfix" role="form"   name="reservationform" id="reservationform">          
          <div class="row">
              <div class="col-sm-2" >
                  <div class="form-group">
                    <label>Đối Tượng Vi Phạm</label>
				    <input name="baocao_cmt" type="text" id="baocao_cmt" value="@ViewBag.keyword" class="form-control" placeholder="Nhập tên hoặc số cmt, hộ chiếu của đối tượng" onkeyup="baocao_timhoso();"/>
                  </div>
              </div>
              <div class="col-sm-2" >
                  <div class="form-group">
                    <label>Từ ngày</label>
				    <input name="fromdate" type="date" id="fromdate" value="@dvhd.Config.showDate((DateTime)@ViewBag.fdate)" class="form-control" placeholder="Từ ngày" />              
                  </div>
              </div>
              <div class="col-sm-2" >
                  <div class="form-group">
                    <label>Đến ngày</label>
				    <input name="todate" type="date" id="todate" value="@dvhd.Config.showDate((DateTime)@ViewBag.tdate)" class="form-control" placeholder="Đến ngày" />               
                  </div>
              </div>
              <div class="col-sm-2" >
                  <div class="form-group">
                    <label>Tìm</label>
				    <input type="button" style="height:32px;" value="Tìm kiếm" onclick="timhoso();">          
                  </div>
              </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section> 

@if (Model.PageCount > 1)
{
    <div class="col-md-12">
    <ul class="pagination clearfix">
            <li class="disabled"><a href="#">«</a></li>
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                if (i != ViewBag.page)
                {
                   <text><li><a href="/hoso/Index?page=@i&keyword=@ViewBag.keyword&fromdate=@ViewBag.fromdate&todate=@ViewBag.todate">@i</a></li></text>
                }
                else
                {
                   <text><li><a href="/hoso/Index?page=@i&keyword=@ViewBag.keyword&fromdate=@ViewBag.fromdate&todate=@ViewBag.todate" style="background-color:#ddd ;">@i</a></li></text>
                }
            }
    </ul>
    </div>
}

<p style="margin-left:5px;font-size:14px;font-weight:bold;">
    <img src="/Images/create.png" height="32" width="32" style="margin-right:2px;">@Html.ActionLink("Thêm Mới Hồ Sơ", "Create")
</p>
<table class="tbBanIn" style="margin-left:5px;margin-right:5px;">
    <tr>
        <th>
            Tên đối tượng
        </th>
        <th>
            Số CMT/Hộ chiếu
        </th>
        <th>
            Địa chỉ
        </th>
        <th>
            Quận huyện
        </th>
        <th>
            Tỉnh thành
        </th>
        <th>
            Hành vi vi phạm
        </th>
        <th>
            Số lượng chi tiết
        </th>
        <th>
            Loài vi phạm
        </th>        
        <th></th>
    </tr>

@foreach (var item in Model)
{
    <tr>
        <td width="15%">
            @item.hoten
        </td>
         <td>
            @item.cmthochieu
        </td>
        <td width="15%">
            @item.hokhauthuongtru
        </td>
        <td>
            @item.quanvipham
        </td>
        <td>
           @item.tinhvipham
        </td>
        <td>
           @item.hanhvivipham
        </td>
        <td width="15%">
           @item.soluongchitiet
        </td>
        <td width="15%">
           @item.loaidongvat
        </td>
        <td width="4%">
            -@Html.ActionLink("Sửa", "Edit", new { id = item.id }) <br />
            -@Html.ActionLink("Hồ Sơ", "Details", new { id = item.id }, new { target = "_blank" }) <br />
            -@Html.ActionLink("Xóa", "Delete", new { id = item.id })
        </td>
    </tr>
}

</table>
@if (Model.PageCount > 1)
{
    <div class="col-md-12">
    <ul class="pagination clearfix">
            <li class="disabled"><a href="#">«</a></li>
            @for (int i = 1; i <= Model.PageCount; i++)
            {
                if (i != ViewBag.page)
                {
                   <text><li><a href="/hoso/Index?page=@i&keyword=@ViewBag.keyword&fromdate=@ViewBag.fromdate&todate=@ViewBag.todate">@i</a></li></text>
                }
                else
                {
                   <text><li><a href="/hoso/Index?page=@i&keyword=@ViewBag.keyword&fromdate=@ViewBag.fromdate&todate=@ViewBag.todate" style="background-color:#ddd ;">@i</a></li></text>
                }
            }
    </ul>
    </div>
}
<script>
    function timhoso() {
        var keyword = document.getElementById("baocao_cmt").value;
        var fromdate = getDateIdNew(document.getElementById("fromdate").value);
        var todate = getDateIdNew(document.getElementById("todate").value);
        var urlTime = "&fromdate=" + fromdate + "&todate=" + todate;
        window.location.href = "/hoso/Index?page=1&keyword=" + keyword + urlTime;
    }
    function baocao_timhoso() {
        var keyword = document.getElementById("baocao_cmt").value;
        
      
        urlSearch = '/Home/getCMT?keyword=';
        

        $('#baocao_cmt').autocomplete({
            source: urlSearch + keyword,
            select: function (event, ui) {
                $(event.target).val(ui.item.value);
                timhoso();
                return false;
            },
            minLength: 1
        });
    }
</script>